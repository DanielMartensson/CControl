/*
 ============================================================================
 Name        : mul.c
 Author      : Daniel Mårtensson
 Version     : 1.0
 Copyright   : MIT
 Description : Do multiplication C = A*B and y = A*x
 ============================================================================
 */

#include "CControl/ccontrol.h"

#define row_a 6
#define column_a 5
#define row_b 5
#define column_b 4
#define row_d 10
#define column_d 3
#define row_e 3
#define column_e 5
#define row_x column_a
#define row_y row_a

int main() {

	/* Matrix A */
	float A[row_a * column_a] = { 0.762664,   0.361977,   0.914004,   0.166355,   0.535495,
								  0.287733,   0.442407,   0.822338,   0.655626,   0.083685,
								  0.733371,   0.122252,   0.815606,   0.196840,   0.080970,
								  0.777981,   0.688653,   0.530031,   0.969136,   0.572176,
								  0.473056,   0.341139,   0.029444,   0.942228,   0.544707,
								  0.663111,   0.463252,   0.121968,   0.195217,   0.359241 };

	/* Matrix B */
	float B[row_b * column_b] = { 0.92328,   -0.34648,   0.048628,   0.37831,
								  0.68159,   -0.88784,    0.15051, -0.75803,
								 -1.4826,    -0.9292,    0.66246,   0.10538,
								 -1.1814,    -1.1721,    0.41475,  -1.5987,
								  0.45405,  -0.017653,  -0.10867,   0.17937 };

	/* Matrix C */
	float C[row_a * column_b];

	/* Matrix D */
	float D[row_d * column_d] = { 0.097508,   0.032488,   0.556151,
								   0.890866,   0.068118,   0.386100,
								   0.139855,   0.598266,   0.059868,
								   0.330958,   0.629458,   0.708821,
								   0.707166,   0.564983,   0.831177,
								   0.406175,   0.677994,   0.187402,
								   0.754571,   0.844057,   0.237162,
								   0.043919,   0.984202,   0.413311,
								   0.893115,   0.086928,   0.329619,
								   0.485586,   0.024933,   0.757906 };

	/* Matrix E */
	float E[row_e * column_e] = { 0.241148, - 0.264190,   0.694877, - 0.045809, - 1.078798,
								   1.395292,   1.283588, - 0.521769,   1.725932, - 0.164939,
								   1.639163, - 0.558058, - 1.306761, - 0.035356,   0.410291 };

	/* Matrix F */
	float F[row_d * column_e];

	/* Vector x */
	float x[row_x] = { -1.5390,
					   -0.6372,
						2.7751,
					   -0.8823,
					   -0.5455 };

	/* Vector y */
	float y[row_y];


	/* Do mul: C = A*B */
	clock_t start, end;
	float cpu_time_used;
	start = clock();
	mul(A, B, C, row_a, column_a, column_b);
	mul(A, x, y, row_a, column_a, 1);
	mul(D, E, F, row_d, column_d, column_e);
	end = clock();
	cpu_time_used = ((float)(end - start)) / CLOCKS_PER_SEC;
	printf("\nTotal speed  was %f\n", cpu_time_used);

	/* Print C matrix */
	print(C, row_a, column_b);

	/* Print y vector */
	print(y, row_a, 1);

	/* Print F matrix */
	print(F, row_d, column_e);

	return EXIT_SUCCESS;
}

/*
 * GNU Octave code:
	 * >> A
	A =

		  0.76266      0.36198        0.914      0.16636       0.5355
		  0.28773      0.44241      0.82234      0.65563     0.083685
		  0.73337      0.12225      0.81561      0.19684      0.08097
		  0.77798      0.68865      0.53003      0.96914      0.57218
		  0.47306      0.34114     0.029444      0.94223      0.54471
		  0.66311      0.46325      0.12197      0.19522      0.35924

	>> B
	B =

		  0.92328     -0.34648     0.048628      0.37831
		  0.68159     -0.88784      0.15051     -0.75803
		  -1.4826      -0.9292      0.66246      0.10538
		  -1.1814      -1.1721      0.41475      -1.5987
		  0.45405    -0.017653     -0.10867      0.17937

	>> C = A*B
	C =

		  -0.3576      -1.6394      0.70786    -0.059444
		  -1.3886      -2.0265      0.88817       -1.173
		 -0.64455      -1.3526      0.66721    -0.029439
		 -0.48332      -2.5195      0.83237      -1.6185
		 -0.24024      -1.6082      0.42544      -1.4851
		  0.67963     -0.98954      0.22469     -0.33509

	>>
 */